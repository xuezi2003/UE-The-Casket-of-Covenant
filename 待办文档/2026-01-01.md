# 2026-01-01 待办

> [!IMPORTANT]
> **后期所有技能完成后，统一调整技能互斥关系**（Ability Blocked Tags / Cancel Tags）

## 当前阶段：关卡1 耐力之匣 - Phase 1 基础移动

### 今日完成
- [x] 蹲行系统
  - [x] IA_Core_Crouch 配置
  - [x] GA_Crouch 实现（Toggle 模式）
  - [x] GE_Crouch（速度降低 + Crouching 标签）
  - [x] Effect.Container.Crouch 标签添加
  - [x] 蹲行系统文档创建
- [x] 蹲行动画集成
  - [x] ABP_Character 添加 bIsCrouching 变量
  - [x] Idle 和 Walk/Run 状态使用 Blend Poses by bool
  - [x] 修复 Server 动画不更新问题（CharacterMesh0 → Always Tick Pose）

### 待办
- [ ] 跳跃体力消耗
  - [ ] GE_StaminaCost_Jump（按次消耗）
  - [ ] GA_Jump 集成体力消耗

---

## 开发计划

### Phase 0：测试环境搭建（✅ 完成）

### Phase 1：基础移动 + 玩家交互

**开发顺序**：Ability → 玩家输入 → AI BTTask

- [ ] 基础移动系统
  - [x] 奔跑体力消耗（GE_StaminaDrain_Sprint）
  - [x] 体力自动回复（GE_StaminaRegen）
  - [x] 力竭机制（GE_Exhausted + GA_Exhausted）
  - [x] 蹲行系统（GA_Crouch + GE_Crouch）
  - [ ] 跳跃体力消耗（GE_StaminaCost_Jump）
- [ ] 推搡系统
  - [ ] GA_Push（推搡 Ability）
  - [ ] 玩家输入绑定
  - [ ] BTTask_Push（AI 触发）
- [ ] 闪避系统
  - [ ] GA_Dodge（闪避 Ability）
  - [ ] 玩家输入绑定
  - [ ] BTTask_Dodge（AI 触发）
- [ ] 失衡/摔倒状态
  - [ ] GA_Stagger（失衡状态）
  - [ ] GA_Fall（摔倒状态）
  - [ ] 玩家 QTE 恢复
  - [ ] AI 概率判定
- [ ] DetectionBox 组件（检测前方可交互对象）

### Phase 2：道具系统
- [ ] 投掷类（MOTS 插件）：香蕉皮、炸弹
- [ ] Buff 类（GE）：跑鞋、护盾、磁铁
- [ ] 资源类：金币

### Phase 3：完善
- [ ] 死亡判定（HP 归零 → 淘汰）
- [ ] 死亡广播（周围玩家失衡）
- [ ] AI 完善（体力管理、遮挡策略）

---

## 架构备忘

**职责分离**：
- Comp_Endurance：检测逻辑（移动检测、Danger 标签）
- AbilitySet_Endurance：GAS 操作（推搡、闪避、投掷、失衡、摔倒、麻痹）
- GE 系列：状态效果
- IMC_Endurance：关卡1/5 专属输入
- BT_Endurance：AI 行为

**AI 设计原则**：
- 操作层统一，触发层分离
- 玩家和 AI 共用同一套 GAS Ability
- 失衡 QTE：玩家走 UI，AI 按概率判定
