# 关卡1 耐力之匣 (L_Endurance)

## 核心玩法

**红绿灯机制**
- 红灯：鬼转头监视，玩家必须静止，任何移动→死亡
- 绿灯：鬼背对，可自由移动
- 视线遮挡：躲在障碍物或其他玩家后面可规避检测

## 开始/结束条件

**开始条件**：所有玩家加载完成，AI 最先生成填充空位

**结束条件**（满足任一）：
- 限时结束（比如8分钟）
- 玩家全部到达终点
- 场上没有真人了，整个DS关闭

## 玩家状态

| 安全状态 | 危险状态 |
|:---------|:-----------------------|
| 静止、被遮挡、**失衡** | 行走（包括蹲行）、奔跑、推搡、闪避、投掷、摔倒、麻痹 |

## 玩家操作/技能

| 操作 | 说明 |
|:-----|:-----|
| 行走 | 普通移动 |
| 奔跑 | 加速移动（使用倍率实现） |
| 蹲行 | 低姿态，可利用遮挡 |
| 推搡 | 使目标失衡 |
| 闪避 | 躲避推搡 |
| 投掷 | 使用投掷道具 |
| 失衡 | 必须要QTE恢复，不然会摔倒 |
| 摔倒 | 摔倒包括摔倒+起身 |
| 麻痹 | 被炸弹击中，触电般抖动，算移动 |

## 特殊状态

| 状态 | 持续时间 | 是否算"移动" | 可中断 |
|:-----|:---------|:------------:|:------:|
| **1. 失衡** | 最长10秒 | ❌ **不算** | ✅ QTE成功可结束 |
| **2. 摔倒** | 约3秒 | ✅ **算移动** | ❌ 不可中断 |
| **3. 麻痹** | 约3秒 | ✅ **算移动** | ❌ 不可中断 |

- 什么时候会进入失衡： 被其他玩家推搡、被死亡惊吓、被香蕉皮作用
- 什么时候会摔倒： 失衡QTE失败、推人被闪避
- 什么时候会麻痹： 被炸弹击中

## 道具系统

所有的道具都是碰到就算拾取

### 投掷类（单槽位，新覆盖旧）

估计这个也会采用状态树来控制状态的变化

香蕉皮：待拾取-拿在手上-丢出过程中-丢到人：作用-丢到其他比如地面：变成陷阱
炸弹：待拾取-拿在手上-丢出过程中-丢到人：作用-丢到其他比如地面：范围爆炸

一次只能持有一个，再碰到时会被覆盖，拿在手上的时候不能拾取

| 道具 | 命中玩家 | 落地 |
|:-----|:---------|:-----|
| 香蕉皮 | 失衡 | 变陷阱 |
| 炸弹 | 麻痹 | 范围爆炸 |

### Buff 类

再次拾取时间会被覆盖

| 道具 | 效果 |
|:-----|:-----|
| 跑鞋 | 加速 |
| 护盾 | 免疫一次伤害/失衡 |
| 磁铁 | 自动吸附金币 |

### 资源类

| 道具 | 说明 |
|:-----|:-----|
| 金币 | 积分 |

金币存在玩家的属性里面，跨关卡存在

## 场景

空旷的教室，前方巨型木偶监视，散落着桌椅

- 空旷场地，前方巨型木偶监视
- 障碍物随机分布（遮挡用，可用PCG）
- 道具随机刷新（可用PCG）

## 其他机制

- **死亡广播**：范围伤害，周围玩家失衡

---

## 关卡专属 GAS 设计

### 体力消耗机制


### 遮挡机制


## 木偶视线检测 (Target System Plugin)

### 实现方案

### 红灯检测逻辑
