# 输入与属性系统

## 一、输入映射

### IMC 分层设计

| IMC | 内容 | 使用场景 | 实现状态 |
|-----|------|----------|----------|
| IMC_Core | 移动、视角、跳跃 | 所有关卡，始终激活 | ✅ 已实现 |
| IMC_Endurance | 蹲、奔跑 | 关卡1、5 | ❌ 待实现 |
| IMC_Courage | 戴/摘面具 | 关卡3 | ❌ 待实现 |

**输入管理方式**
- GAS 操作（推搡、闪避等）→ Ability Set 自动绑定/解绑
- 非 GAS 操作（蹲、奔跑等）→ 手动 Add/Remove MappingContext

### IMC_Core 输入动作列表

| Input Action | 按键 | 触发器 | 实现状态 |
|--------------|------|--------|----------|
| IA_Core_Move | WASD | - | ✅ 已实现 |
| IA_Core_Look | 鼠标 | - | ✅ 已实现 |
| IA_Core_Jump | 空格 | 已按下 + 已松开 | ✅ 已实现 |
| IA_Core_Sprint | 左Shift | 下移 (0.5) | ❌ 输入已配置，逻辑未实现 |
| IA_Core_Crouch | C | 已按下 (0.5) | ❌ 输入已配置，逻辑未实现 |

### 移动输入配置

| 按键 | 修改器 |
|------|--------|
| W | 拼合输入轴值 (YXZ) |
| S | 拼合输入轴值 (YXZ) + 否定 |
| A | 否定 (XYZ) |
| D | - |

### 视角输入配置

- 输入：鼠标 XY 2D轴
- 修改器：否定 (Z轴)

---

## 二、属性集 (BAS_Core)

使用 Blueprint Attributes 插件创建，GAS 系统尚未正式启用。

### 属性列表

| 属性 | 基础值 | 最小值 | 最大值 | 说明 |
|------|--------|--------|--------|------|
| Coin | 0 | 0 | 无限制 | 金币（跨关卡） |
| Health | 100 | 0 | 100 | 生命值 |
| Stamina | 100 | 0 | Max Stamina | 体力 |
| Max Stamina | 100 | - | - | 最大体力 |
| Speed Rate | 1.0 | - | - | 速度倍率 |
| Base Speed | 350 | - | - | 基础速度 |

### 属性用途

- **Coin**：金币积分，跨关卡保留
- **Health**：生命值，归零即淘汰
- **Stamina**：体力，用于奔跑等消耗
- **Speed Rate**：速度倍率，奔跑时修改此值
- **Base Speed**：基础移动速度

### 速度计算

```
最大行走速度 = Base Speed × Speed Rate
```

在 `HandleSpeedRateChange` 中实现，当 SpeedRate 属性变化时自动更新 Character Movement 的最大行走速度。

---

## 三、GSC 组件配置

### GSCCore

| 设置 | 值 | 说明 |
|------|-----|------|
| 组件复制 | ✅ | ASC 需要复制属性到客户端 |
| 启用 Tick | ✅ | 可选，不需要可关闭 |
| 自动启用 | ❌ | 由系统自动管理 |

### GSCAbilityInputBinding

| 设置 | 值 | 说明 |
|------|-----|------|
| 组件复制 | ❌ | 输入绑定只在本地客户端 |
| Input Mapping Context | IMC_Core | 输入映射上下文 |
| 自动启用 | ❌ | - |
